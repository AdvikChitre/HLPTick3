import { comparePrimitives, curry2, uncurry2, equals, createAtom } from "../fable_modules/fable-library.4.1.4/Util.js";
import { Cmd_batch, Cmd_none } from "../fable_modules/Fable.Elmish.3.1.0/cmd.fs.js";
import { Cmd_OfAsyncWith_result, Cmd_OfFunc_result } from "../fable_modules/Fable.Elmish.3.1.0/./cmd.fs.js";
import { singleton, empty, ofArray, skip, average, reduce, filter, length, tryFind, cons, map } from "../fable_modules/fable-library.4.1.4/List.js";
import { getTimeMs } from "../Common/TimeHelpers.fs.js";
import { traceMessage, executePendingMessagesF, writeUserData, readUserData, processContextMenuClick, getContextMenu, getMenuView, updateComponentMemory, getSimulationDataOrFail, filterByOKSheets, processSheetBackAction, sheetMsg, exitApp, resetDialogIfSelectionHasChanged, updateAllMemoryCompsIfNeeded, isSameMsg, matchMouseMsg } from "./UpdateHelpers.fs.js";
import { MouseOp } from "../Common/DrawHelpers.fs.js";
import { drawBlockTestState_, UserData, userData_, fromProperties_, fromMemoryEditor_, fromFiles_, fromWaveSim_, fromSimulation_, notifications_, fromDiagram_, selectedComponent_, progress_, memoryEditorData_, memorySetup_, intlist2_, intlist_, int2_, int_, verilogErrors_, verilogCode_, badLabel_, text_, PopupDialogData as PopupDialogData_1, popupViewFunc_, currentProj_, projectPath_, buildVisible_, simSubTabVisible_, rightPaneTabVisible_, WaveSimModel, WaveSimState, currentStepSimulationStep_, waveSim_, popupDialogData_, importDecisions_, waveSimSheet_, uISheetTrail_, openLoadedComponentOfModel_, Msg, Model } from "../Model/ModelType.fs.js";
import { Compose_Lens, Compose_Lens_op_GreaterMinusGreater_Z15C92E89, Optic_Set, Optic_Set_op_HatEquals_Z147477F8, Optic_Map_op_HatPercent_Z32F545AB, Optics_fst_, Optic_Map, Optic_Map_op_HatPercent_Z1462312A } from "../Common/Optics.fs.js";
import { updateProjectFiles, optCurrentSheetDependentsPopup } from "./CustomCompPorts.fs.js";
import { SheetT_Msg } from "../Model/DrawModelType.fs.js";
import { map as map_1 } from "../fable_modules/fable-library.4.1.4/Option.js";
import { DrawModelType_SheetT_Model__Model_GetCanvasState } from "../DrawBlock/Sheet.fs.js";
import { HighLightColor, JSDiagramMsg, LoadedComponent } from "../Common/CommonTypes.fs.js";
import { dirName } from "../Interface/FilesIO.fs.js";
import { toFail, printf, toConsole } from "../fable_modules/fable-library.4.1.4/String.js";
import { doBatchOfMsgsAsynch, simulateWithProgressBar, tryStartSimulationAfterErrorFix, Constants_maxArraySize } from "./SimulationView.fs.js";
import { startCircuitSimulation } from "../Simulator/Simulator.fs.js";
import { toList, filter as filter_1, length as length_1 } from "../fable_modules/fable-library.4.1.4/Seq.js";
import { empty as empty_1, change, add, FSharpMap__get_Values } from "../fable_modules/fable-library.4.1.4/Map.js";
import { runFastSimulation } from "../Simulator/Fast/FastRun.fs.js";
import { rangeDouble } from "../fable_modules/fable-library.4.1.4/Range.js";
import { execOneAsyncJobIfPossible, userDataToDrawBlockModel, removeAllSimulationsFromModel, getWSModel, updateWSModel, setWSModel } from "./ModelHelpers.fs.js";
import { refreshWaveSim } from "./WaveSim/WaveSim.fs.js";
import { setWaveSheetSelectionOpen, setWaveGroupSelectionOpen, setWaveComponentSelectionOpen } from "./WaveSim/WaveSimHelpers.fs.js";
import { clockTickNumber_, numberBase_, fastSim_, graph_ } from "../Simulator/SimulatorTypes.fs.js";
import { FSharpResult$2 } from "../fable_modules/fable-library.4.1.4/Choice.js";
import { firstTip } from "./CatalogueView.fs.js";
import { update as update_3 } from "../DrawBlock/SheetUpdate.fs.js";
import * as react from "react";
import { closablePopup } from "../DrawBlock/PopupHelpers.fs.js";
import { CSSProp } from "../fable_modules/Fable.React.8.0.1/Fable.React.Props.fs.js";
import { toInt32 } from "../fable_modules/fable-library.4.1.4/BigInt.js";
import { sleep, startImmediate } from "../fable_modules/fable-library.4.1.4/Async.js";
import { singleton as singleton_1 } from "../fable_modules/fable-library.4.1.4/AsyncBuilder.js";
import { contains } from "../fable_modules/fable-library.4.1.4/Set.js";
import { debugTraceUI } from "../Interface/JSHelpers.fs.js";
import * as electron from "electron";
import { truthTableUpdate } from "./TruthTable/TruthTableUpdate.fs.js";

export let uiStartTime = createAtom(0);

/**
 * Main MVU model update function
 */
export function update(msg, oldModel) {
    let popup, sMsg, canvas, canvas_1, mode, w, dispatch, updateFun, width, step, warmup, simulationRound, benchmarkRound, geometricMean, benchmark, arg_17, simData_2, wsModel, updateFn, wsSheet, wsModel_1, value_1, updateFn_1, importDecisions$0027, updatedModel, ws, wsModel_2, sheet_1, ws_1, ws_2, show, fIdL, show_1, fIdL_1, show_2, fIdL_2, simType, graph, fastSim, simData_3, arg_24, f1_1, numBase, simData_4, n, simData_5, model_10, model_9, matchValue_5, sheet_2, newTab, inferMsg, editMsgs, subTab, inferMsg_1, editMsgs_1, connectionIds, componentIds, connIds, components, pos, project, update_1, update_2, popup_1, title, dispatch_1, body, foot, inputRecord, text, isBad, code, errorList, int, int_1, select, optText, n_1, f_5, value_23, intlist, intlist2, m, m_1, progOpt, updateFn_5, simPars, data, addr, n_2, n_3, n_4, n_5, t, f_8, dispatch_2, cmd_1, func, cmd$0027, cmd_3, cmd$0027_1, msgs_1, dispatch_3, act, testNum, testFunc, e, menuType, menuType_1, item, dispatch_4, b, cmd_4, userAppDir, patternInput_1, model_11, cmd_5, data_1, theme, model_15, inputRecord_1, func_1, n_6, ttMsg, uiCmd;
    const withNoMsg = (model) => [model, Cmd_none()];
    const withMsg = (msg_1, model_1) => [model_1, Cmd_OfFunc_result(msg_1)];
    const withMsgs = (msgs, model_2) => [model_2, Cmd_batch(map(Cmd_OfFunc_result, msgs))];
    const startOfUpdateTime = getTimeMs();
    const model_3 = matchMouseMsg((mMsg) => equals(mMsg.Op, new MouseOp(3, [])), msg) ? (new Model(oldModel.UserData, oldModel.WaveSim, oldModel.WaveSimSheet, oldModel.UISheetTrail, oldModel.Spinner, oldModel.Sheet, oldModel.IsLoading, oldModel.LastChangeCheckTime, oldModel.LastSimulatedCanvasState, oldModel.LastDetailedSavedState, oldModel.CurrentSelected, oldModel.LastSelectedIds, oldModel.LastUsedDialogWidth, oldModel.SelectedComponent, oldModel.CurrentStepSimulationStep, oldModel.CurrentTruthTable, oldModel.TTConfig, oldModel.RightPaneTabVisible, oldModel.SimSubTabVisible, oldModel.Hilighted, oldModel.Clipboard, oldModel.LastCreatedComponent, oldModel.SavedSheetIsOutOfDate, oldModel.CurrentProj, oldModel.PopupViewFunc, oldModel.SpinnerPayload, oldModel.PopupDialogData, oldModel.Notifications, oldModel.TopMenuOpenState, oldModel.DividerDragMode, oldModel.WaveSimViewerWidth, oldModel.ConnsOfSelectedWavesAreHighlighted, cons(msg, oldModel.Pending), oldModel.UIState, oldModel.BuildVisible, oldModel.DrawBlockTestState)) : oldModel;
    let patternInput;
    const _arg = tryFind((x) => isSameMsg()(x)(msg), model_3.Pending);
    patternInput = ((_arg == null) ? [msg, Cmd_none()] : [new Msg(81, []), Cmd_OfFunc_result(new Msg(80, [length(model_3.Pending)]))]);
    const testMsg = patternInput[0];
    const cmd = patternInput[1];
    const model_4 = updateAllMemoryCompsIfNeeded(model_3);
    let tupledArg_2;
    const tupledArg_1 = Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), Optics_fst_())((model$0027) => resetDialogIfSelectionHasChanged(model$0027, oldModel))((testMsg.tag === 83) ? ((popup = optCurrentSheetDependentsPopup(model_4), withMsg(new Msg(1, [new SheetT_Msg(29, [false])]), new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, map_1(uncurry2, popup), model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, void 0, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 78) ? ((exitApp(model_4), [model_4, Cmd_none()])) : ((testMsg.tag === 1) ? ((sMsg = testMsg.fields[0], (sMsg.tag === 27) ? ((canvas = sMsg.fields[0], [model_4, Cmd_none()])) : ((sMsg.tag === 2) ? ((model_4.PopupViewFunc != null) ? [model_4, Cmd_none()] : sheetMsg(sMsg, model_4)) : sheetMsg(sMsg, model_4)))) : ((testMsg.tag === 4) ? ((canvas_1 = DrawModelType_SheetT_Model__Model_GetCanvasState(model_4.Sheet), withNoMsg(Optic_Map_op_HatPercent_Z32F545AB(new Optic_Map(), openLoadedComponentOfModel_)((ldc) => (new LoadedComponent(ldc.Name, ldc.TimeStamp, ldc.FilePath, ldc.WaveInfo, canvas_1, ldc.InputLabels, ldc.OutputLabels, ldc.Form, ldc.Description)))(model_4)))) : ((testMsg.tag === 70) ? ((mode = testMsg.fields[0], withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, mode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 72) ? ((w = (testMsg.fields[0] | 0), withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, w, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 3) ? ((dispatch = testMsg.fields[0], withNoMsg(processSheetBackAction(dispatch, model_4)))) : ((testMsg.tag === 2) ? ((updateFun = testMsg.fields[0], withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), uISheetTrail_)((arg_2) => filter((sheet) => filterByOKSheets(model_4, sheet), updateFun(arg_2)))(model_4)))) : ((testMsg.tag === 69) ? ((width = (testMsg.fields[0] | 0), withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, width, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 7) ? ((step = 2000, (warmup = 5, (simulationRound = 10, (benchmarkRound = 20, (geometricMean = ((values) => {
        const arg0__5 = reduce((x_1, y) => (x_1 * y), values);
        const arg1__4 = 1 / length(values);
        return Math.pow(arg0__5, arg1__4);
    }), (benchmark = ((i) => {
        const matchValue_3 = model_4.CurrentProj;
        if (matchValue_3 == null) {
            throw new Error("No project loaded, please load a project to benchmark");
        }
        else {
            const p = matchValue_3;
            const arg_4 = dirName(p.ProjectPath);
            toConsole(printf("Benchmarking on %20s, stepArraySize %8d, step %8d, warmup %3d, repeat %3d"))(arg_4)(Constants_maxArraySize)(step)(warmup)(simulationRound);
            return geometricMean(map((c) => {
                let simData;
                const tupledArg = c.CanvasState;
                simData = startCircuitSimulation(Constants_maxArraySize, c.Name, tupledArg[0], tupledArg[1], p.LoadedComponents);
                if (simData.tag === 0) {
                    const simData_1 = simData.fields[0];
                    const comps = length_1(filter_1((fc) => {
                        if (fc.FType.tag === 3) {
                            return false;
                        }
                        else {
                            return true;
                        }
                    }, FSharpMap__get_Values(simData_1.FastSim.FComps))) | 0;
                    toConsole(printf("Benchmarking with component: %s"))(c.Name);
                    const time = average(skip(warmup, map((_arg_1) => {
                        simData_1.FastSim.ClockTick = 0;
                        const start = getTimeMs();
                        runFastSimulation(void 0, step, simData_1.FastSim);
                        return getTimeMs() - start;
                    }, toList(rangeDouble(1, 1, warmup + simulationRound)))), {
                        GetZero: () => 0,
                        Add: (x_3, y_1) => (x_3 + y_1),
                        DivideByInt: (x_2, i_1) => (x_2 / i_1),
                    });
                    const speed = (comps * step) / time;
                    toConsole(printf("simulated %20s for %5d steps with %4d effective components, simulation finished in %8.3fms, average simulation speed: %10.3f (comp * step / ms)"))(c.Name)(step)(comps)(time)(speed);
                    return speed;
                }
                else {
                    const err = simData.fields[0];
                    return toFail(printf("Error occured when running startCircuitSimulation on %A, %A"))(c.Name)(err);
                }
            }, p.LoadedComponents));
        }
    }), ((arg_17 = map(benchmark, toList(rangeDouble(1, 1, benchmarkRound))), toConsole(printf("Geometric mean of simulation speed of ISSIE on current project: %A"))(arg_17)), [model_4, Cmd_none()])))))))) : ((testMsg.tag === 8) ? ((simData_2 = testMsg.fields[0], withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, simData_2, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 10) ? ((wsModel = testMsg.fields[0], withNoMsg(setWSModel(wsModel, model_4)))) : ((testMsg.tag === 11) ? ((updateFn = testMsg.fields[0], withNoMsg(updateWSModel(updateFn, model_4)))) : ((testMsg.tag === 12) ? ((wsSheet = testMsg.fields[1], (wsModel_1 = testMsg.fields[0], withNoMsg(setWSModel(wsModel_1, ((value_1 = ((wsSheet === "") ? void 0 : wsSheet), Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), waveSimSheet_)(value_1)))(model_4)))))) : ((testMsg.tag === 36) ? ((updateFn_1 = testMsg.fields[0], [updateFn_1(model_4), Cmd_none()])) : ((testMsg.tag === 37) ? ((importDecisions$0027 = testMsg.fields[0], (updatedModel = Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), importDecisions_)(popupDialogData_))(importDecisions$0027)(model_4), [updatedModel, Cmd_none()]))) : ((testMsg.tag === 15) ? ((ws = testMsg.fields[0], refreshWaveSim(true, ws, model_4))) : ((testMsg.tag === 9) ? ((wsModel_2 = testMsg.fields[0][1], (sheet_1 = testMsg.fields[0][0], withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), waveSim_)((table) => add(sheet_1, wsModel_2, table))(model_4))))) : ((testMsg.tag === 13) ? ((ws_1 = testMsg.fields[0], refreshWaveSim(false, ws_1, model_4))) : ((testMsg.tag === 14) ? ((ws_2 = getWSModel(model_4), refreshWaveSim(false, ws_2, model_4))) : ((testMsg.tag === 17) ? ((show = testMsg.fields[0][1], (fIdL = testMsg.fields[0][0], withNoMsg(updateWSModel((ws_3) => setWaveComponentSelectionOpen(ws_3, fIdL, show), model_4))))) : ((testMsg.tag === 18) ? ((show_1 = testMsg.fields[0][1], (fIdL_1 = testMsg.fields[0][0], withNoMsg(updateWSModel((ws_4) => setWaveGroupSelectionOpen(ws_4, fIdL_1, show_1), model_4))))) : ((testMsg.tag === 16) ? ((show_2 = testMsg.fields[0][1], (fIdL_2 = testMsg.fields[0][0], withNoMsg(updateWSModel((ws_5) => setWaveSheetSelectionOpen(ws_5, fIdL_2, show_2), model_4))))) : ((testMsg.tag === 21) ? ((simType = testMsg.fields[0], tryStartSimulationAfterErrorFix(simType, model_4))) : ((testMsg.tag === 22) ? ((graph = testMsg.fields[0], (fastSim = testMsg.fields[1], (simData_3 = (new FSharpResult$2(0, [(arg_24 = getSimulationDataOrFail(model_4, "SetSimulationGraph"), (f1_1 = Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), graph_)(graph), Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), fastSim_)(fastSim)(f1_1(arg_24))))])), withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), currentStepSimulationStep_)(simData_3)(model_4)))))) : ((testMsg.tag === 23) ? ((numBase = testMsg.fields[0], (simData_4 = Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), numberBase_)(numBase)(getSimulationDataOrFail(model_4, "SetSimulationBase")), withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), currentStepSimulationStep_)(new FSharpResult$2(0, [simData_4]))(model_4))))) : ((testMsg.tag === 24) ? ((n = (testMsg.fields[0] | 0), (simData_5 = Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), clockTickNumber_)((x_4) => (x_4 + n))(getSimulationDataOrFail(model_4, "IncrementSimulationClockTick")), withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), currentStepSimulationStep_)(new FSharpResult$2(0, [simData_5]))(model_4))))) : ((testMsg.tag === 25) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), currentStepSimulationStep_)(void 0)(model_4)) : ((testMsg.tag === 26) ? ((model_10 = ((model_9 = removeAllSimulationsFromModel(model_4), (matchValue_5 = model_9.WaveSimSheet, (matchValue_5 != null) ? ((matchValue_5 === "") ? ((toConsole(printf("What? can\'t end WaveSim when it is already ended")), model_9)) : ((sheet_2 = matchValue_5, new Model(model_9.UserData, change(sheet_2, (option) => map_1((ws_6) => (new WaveSimModel(new WaveSimState(6, []), ws_6.TopSheet, ws_6.Sheets, ws_6.AllWaves, ws_6.SelectedWaves, ws_6.StartCycle, ws_6.ShownCycles, ws_6.CurrClkCycle, ws_6.ClkCycleBoxIsEmpty, ws_6.Radix, ws_6.WaveformColumnWidth, false, ws_6.RamModalActive, ws_6.RamComps, ws_6.SelectedRams, ws_6.FastSim, ws_6.SearchString, ws_6.ShowSheetDetail, ws_6.ShowComponentDetail, ws_6.ShowGroupDetail, ws_6.HoveredLabel, ws_6.DraggedIndex, ws_6.PrevSelectedWaves)), option), model_9.WaveSim), void 0, model_9.UISheetTrail, model_9.Spinner, model_9.Sheet, model_9.IsLoading, model_9.LastChangeCheckTime, model_9.LastSimulatedCanvasState, model_9.LastDetailedSavedState, model_9.CurrentSelected, model_9.LastSelectedIds, model_9.LastUsedDialogWidth, model_9.SelectedComponent, model_9.CurrentStepSimulationStep, model_9.CurrentTruthTable, model_9.TTConfig, model_9.RightPaneTabVisible, model_9.SimSubTabVisible, model_9.Hilighted, model_9.Clipboard, model_9.LastCreatedComponent, model_9.SavedSheetIsOutOfDate, model_9.CurrentProj, model_9.PopupViewFunc, model_9.SpinnerPayload, model_9.PopupDialogData, model_9.Notifications, model_9.TopMenuOpenState, model_9.DividerDragMode, model_9.WaveSimViewerWidth, model_9.ConnsOfSelectedWavesAreHighlighted, model_9.Pending, model_9.UIState, model_9.BuildVisible, model_9.DrawBlockTestState)))) : ((toConsole(printf("What? can\'t end WaveSim when it is already ended")), model_9))))), [model_10, Cmd_none()])) : ((testMsg.tag === 28) ? ((newTab = testMsg.fields[0], (inferMsg = (new Msg(5, [new JSDiagramMsg(3, [void 0])])), (editMsgs = ofArray([inferMsg, new Msg(67, [])]), (firstTip(true), withMsgs((newTab.tag === 1) ? editMsgs : ((newTab.tag === 2) ? editMsgs : ((newTab.tag === 3) ? editMsgs : ((newTab.tag === 4) ? empty() : editMsgs))), Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), rightPaneTabVisible_)(newTab)(model_4))))))) : ((testMsg.tag === 29) ? ((subTab = testMsg.fields[0], (inferMsg_1 = (new Msg(5, [new JSDiagramMsg(3, [void 0])])), (editMsgs_1 = ofArray([inferMsg_1, new Msg(67, [])]), withMsgs(editMsgs_1, Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), simSubTabVisible_)(subTab)(model_4)))))) : ((testMsg.tag === 71) ? withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), buildVisible_)((value_12) => !value_12)(model_4)) : ((testMsg.tag === 30) ? ((connectionIds = testMsg.fields[1], (componentIds = testMsg.fields[0], update_3(new SheetT_Msg(23, [componentIds, connectionIds, new HighLightColor(0, [])]), model_4)))) : ((testMsg.tag === 31) ? ((connIds = testMsg.fields[0], update_3(new SheetT_Msg(23, [empty(), ofArray(connIds), new HighLightColor(1, [])]), model_4))) : ((testMsg.tag === 32) ? ((components = testMsg.fields[0], withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, components, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 33) ? ((pos = testMsg.fields[0], withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, pos, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 34) ? ((project = testMsg.fields[0], (toConsole(`Setting project with component: '${project.OpenFileName}'`), withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), projectPath_)(popupDialogData_))(project.ProjectPath)(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), currentProj_)(project)(model_4)))))) : ((testMsg.tag === 35) ? ((update_1 = testMsg.fields[0], withNoMsg(updateProjectFiles(true, update_1, model_4)))) : ((testMsg.tag === 38) ? ((update_2 = testMsg.fields[0], withNoMsg(updateProjectFiles(false, update_2, model_4)))) : ((testMsg.tag === 39) ? ((popup_1 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), popupViewFunc_)(curry2(popup_1))(model_4)))) : ((testMsg.tag === 40) ? ((title = testMsg.fields[0][0], (dispatch_1 = testMsg.fields[0][2], (body = testMsg.fields[0][1], (foot = react.createElement("div", {}), (closablePopup(title, body, foot, singleton(new CSSProp(395, [800])), dispatch_1), withNoMsg(model_4))))))) : ((testMsg.tag === 41) ? withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, void 0, model_4.SpinnerPayload, (inputRecord = model_4.PopupDialogData, new PopupDialogData_1(void 0, void 0, empty_1({
        Compare: comparePrimitives,
    }), void 0, inputRecord.ProjectPath, void 0, void 0, inputRecord.Progress, inputRecord.ConstraintTypeSel, inputRecord.ConstraintIOSel, inputRecord.ConstraintErrorMsg, inputRecord.NewConstraint, inputRecord.AlgebraInputs, inputRecord.AlgebraError, void 0, empty(), inputRecord.BadLabel, inputRecord.IntList, inputRecord.IntList2)), model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)) : ((testMsg.tag === 42) ? ((text = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), text_)(popupDialogData_))(text)(model_4)))) : ((testMsg.tag === 43) ? ((isBad = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), badLabel_)(popupDialogData_))(isBad)(model_4)))) : ((testMsg.tag === 44) ? ((code = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), verilogCode_)(popupDialogData_))(code)(model_4)))) : ((testMsg.tag === 45) ? ((errorList = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), verilogErrors_)(popupDialogData_))(errorList)(model_4)))) : ((testMsg.tag === 46) ? ((int = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), int_)(popupDialogData_))(int)(model_4)))) : ((testMsg.tag === 47) ? ((int_1 = testMsg.fields[0], [Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), int2_)(popupDialogData_))(int_1)(model_4), Cmd_none()])) : ((testMsg.tag === 48) ? ((select = testMsg.fields[0][1], (optText = testMsg.fields[0][2], (n_1 = testMsg.fields[0][0], withNoMsg(((f_5 = ((select.tag === 1) ? Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), int2_)(n_1) : ((value_23 = map_1((value_22) => ~~toInt32(value_22), n_1), Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), int_)(value_23)))), Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), popupDialogData_)(f_5)))(model_4)))))) : ((testMsg.tag === 49) ? ((intlist = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), intlist_)(popupDialogData_))(intlist)(model_4)))) : ((testMsg.tag === 50) ? ((intlist2 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), intlist2_)(popupDialogData_))(intlist2)(model_4)))) : ((testMsg.tag === 52) ? ((m = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), memorySetup_)(popupDialogData_))(m)(model_4)))) : ((testMsg.tag === 53) ? ((m_1 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), memoryEditorData_)(popupDialogData_))(m_1)(model_4)))) : ((testMsg.tag === 54) ? ((progOpt = testMsg.fields[0], [Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), progress_)(popupDialogData_))(progOpt)(model_4), Cmd_none()])) : ((testMsg.tag === 55) ? ((updateFn_5 = testMsg.fields[0], withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), progress_)(popupDialogData_))((option_1) => map_1(updateFn_5, option_1))(model_4)))) : ((testMsg.tag === 56) ? ((simPars = testMsg.fields[0], simulateWithProgressBar(simPars, model_4))) : ((testMsg.tag === 57) ? ((data = testMsg.fields[1], (addr = testMsg.fields[0], withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), selectedComponent_)((compOpt) => updateComponentMemory(addr, data, compOpt))(model_4))))) : ((testMsg.tag === 58) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromDiagram_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 59) ? ((n_2 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromSimulation_)(notifications_))(n_2)(model_4)))) : ((testMsg.tag === 60) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromSimulation_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 61) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromWaveSim_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 62) ? ((n_3 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromFiles_)(notifications_))(n_3)(model_4)))) : ((testMsg.tag === 63) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromFiles_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 64) ? ((n_4 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromMemoryEditor_)(notifications_))(n_4)(model_4)))) : ((testMsg.tag === 65) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromMemoryEditor_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 66) ? ((n_5 = testMsg.fields[0], withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromProperties_)(notifications_))(n_5)(model_4)))) : ((testMsg.tag === 67) ? withNoMsg(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), Compose_Lens_op_GreaterMinusGreater_Z15C92E89(new Compose_Lens(), fromProperties_)(notifications_))(void 0)(model_4)) : ((testMsg.tag === 68) ? ((t = testMsg.fields[0], withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, t, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)))) : ((testMsg.tag === 88) ? ((f_8 = testMsg.fields[0], (dispatch_2 = testMsg.fields[1], withNoMsg((f_8(model_4, dispatch_2), model_4))))) : ((testMsg.tag === 87) ? ((cmd_1 = testMsg.fields[0], [model_4, cmd_1])) : ((testMsg.tag === 89) ? ((func = testMsg.fields[0], (cmd$0027 = Cmd_OfAsyncWith_result((arg_94) => {
        startImmediate(arg_94);
    }, singleton_1.Delay(() => singleton_1.Bind(sleep(100), () => singleton_1.Combine(contains("update", debugTraceUI()) ? ((toConsole(printf("Starting ExecFuncAsynch payload")), singleton_1.Zero())) : singleton_1.Zero(), singleton_1.Delay(() => {
        const cmd_2 = func();
        return singleton_1.Return(new Msg(87, [cmd_2]));
    }))))), [model_4, cmd$0027]))) : ((testMsg.tag === 90) ? ((cmd_3 = testMsg.fields[0], (cmd$0027_1 = Cmd_OfAsyncWith_result((arg_95) => {
        startImmediate(arg_95);
    }, singleton_1.Delay(() => singleton_1.Bind(sleep(300), () => singleton_1.Return(new Msg(87, [cmd_3]))))), [model_4, cmd$0027_1]))) : ((testMsg.tag === 91) ? ((msgs_1 = testMsg.fields[0], [model_4, doBatchOfMsgsAsynch(msgs_1)])) : ((testMsg.tag === 73) ? ((dispatch_3 = testMsg.fields[1], (act = testMsg.fields[0], (act.tag === 1) ? [getMenuView(act, model_4, dispatch_3), Cmd_OfFunc_result(new Msg(1, [new SheetT_Msg(37, [])]))] : ((act.tag === 2) ? [getMenuView(act, model_4, dispatch_3), Cmd_OfFunc_result(new Msg(1, [new SheetT_Msg(37, [])]))] : ((act.tag === 8) ? ((testNum = (act.fields[1] | 0), (testFunc = act.fields[0], (testFunc(testNum, dispatch_3, model_4), [model_4, Cmd_none()])))) : [getMenuView(act, model_4, dispatch_3), Cmd_none()]))))) : ((testMsg.tag === 92) ? ((e = testMsg.fields[0], (menuType = getContextMenu(e, model_4), (electron.ipcRenderer.send("show-context-menu", menuType), [model_4, Cmd_none()])))) : ((testMsg.tag === 93) ? ((menuType_1 = testMsg.fields[0], (item = testMsg.fields[1], (dispatch_4 = testMsg.fields[2], processContextMenuClick(menuType_1, item, dispatch_4, model_4))))) : ((testMsg.tag === 74) ? [model_4, Cmd_none()] : ((testMsg.tag === 75) ? withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, true, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)) : ((testMsg.tag === 76) ? ((b = testMsg.fields[0], (cmd_4 = (b ? Cmd_none() : Cmd_OfFunc_result(new Msg(1, [new SheetT_Msg(29, [false])]))), [new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, b, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState), cmd_4]))) : ((testMsg.tag === 84) ? ((userAppDir = testMsg.fields[0], (toConsole(`Got user app dir of ${userAppDir}`), (patternInput_1 = readUserData(userAppDir, model_4), (model_11 = patternInput_1[0], (cmd_5 = patternInput_1[1], [model_11, cmd_5])))))) : ((testMsg.tag === 85) ? ((data_1 = testMsg.fields[0], withNoMsg(writeUserData(userDataToDrawBlockModel(Optic_Set_op_HatEquals_Z147477F8(new Optic_Set(), userData_)(data_1)(model_4)))))) : ((testMsg.tag === 86) ? ((theme = testMsg.fields[0], (model_15 = userDataToDrawBlockModel(new Model((inputRecord_1 = model_4.UserData, new UserData(inputRecord_1.UserAppDir, inputRecord_1.LastUsedDirectory, inputRecord_1.RecentProjects, inputRecord_1.ArrowDisplay, inputRecord_1.WireType, theme)), model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, model_4.UIState, model_4.BuildVisible, model_4.DrawBlockTestState)), [model_15, Cmd_none()]))) : ((testMsg.tag === 94) ? ((func_1 = testMsg.fields[0], withNoMsg(Optic_Map_op_HatPercent_Z1462312A(new Optic_Map(), drawBlockTestState_)(func_1)(model_4)))) : ((testMsg.tag === 80) ? ((n_6 = (testMsg.fields[0] | 0), executePendingMessagesF(n_6, model_4))) : ((testMsg.tag === 27) ? ((ttMsg = testMsg.fields[0], truthTableUpdate(model_4, ttMsg))) : ((testMsg.tag === 19) ? [model_4, Cmd_none()] : ((testMsg.tag === 20) ? [model_4, Cmd_none()] : ((testMsg.tag === 79) ? [model_4, Cmd_none()] : ((testMsg.tag === 51) ? [model_4, Cmd_none()] : ((testMsg.tag === 77) ? [model_4, Cmd_none()] : ((testMsg.tag === 0) ? [model_4, Cmd_none()] : ((testMsg.tag === 81) ? [model_4, cmd] : ((testMsg.tag === 5) ? [model_4, Cmd_none()] : ((testMsg.tag === 6) ? [model_4, Cmd_none()] : ((uiCmd = testMsg.fields[0], (uiStartTime(getTimeMs()), (model_4.UIState == null) ? ((uiCmd.tag === 0) ? withNoMsg(new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, void 0, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, uiCmd, model_4.BuildVisible, model_4.DrawBlockTestState)) : withMsg(new Msg(1, [new SheetT_Msg(29, [true])]), new Model(model_4.UserData, model_4.WaveSim, model_4.WaveSimSheet, model_4.UISheetTrail, model_4.Spinner, model_4.Sheet, model_4.IsLoading, model_4.LastChangeCheckTime, model_4.LastSimulatedCanvasState, model_4.LastDetailedSavedState, model_4.CurrentSelected, model_4.LastSelectedIds, model_4.LastUsedDialogWidth, model_4.SelectedComponent, model_4.CurrentStepSimulationStep, model_4.CurrentTruthTable, model_4.TTConfig, model_4.RightPaneTabVisible, model_4.SimSubTabVisible, model_4.Hilighted, model_4.Clipboard, model_4.LastCreatedComponent, model_4.SavedSheetIsOutOfDate, model_4.CurrentProj, model_4.PopupViewFunc, model_4.SpinnerPayload, model_4.PopupDialogData, model_4.Notifications, model_4.TopMenuOpenState, model_4.DividerDragMode, model_4.WaveSimViewerWidth, model_4.ConnsOfSelectedWavesAreHighlighted, model_4.Pending, uiCmd, model_4.BuildVisible, model_4.DrawBlockTestState))) : [model_4, Cmd_none()])))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))))));
    tupledArg_2 = traceMessage(startOfUpdateTime, msg, tupledArg_1[0], tupledArg_1[1]);
    return execOneAsyncJobIfPossible(tupledArg_2[0], tupledArg_2[1]);
}

//# sourceMappingURL=Update.fs.js.map
